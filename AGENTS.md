# Repository Guidelines

## Project Structure & Module Organization
- `src/commands/rflib/**` houses the TypeScript command implementations by topic.
- `messages/**` stores localized strings for flags, help, and errors; add a peer file for every new command.
- `lib/**` is generated by `yarn compile`; never edit compiled output.
- `test/commands/**` mirrors the CLI tree with Mocha specs (`*.test.ts`) and slower NUT suites (`*.nut.ts`).
- `bin/dev.js` runs the plugin through ts-node without linking, and coverage artifacts live in `coverage/`.

## Build, Test, and Development Commands
- `yarn compile` calls `tsc -p .` and refreshes the `lib` folder.
- `yarn build` chains compile and lint through Wireit for a single gate.
- `yarn lint` enforces Salesforce plugin ESLint rules; `yarn format` applies `@salesforce/prettier-config`.
- `yarn test` runs lint plus the complete Mocha matrix; use `yarn test:only` during iteration and `yarn test:nuts` for integration checks.
- `yarn clean` or `yarn clean-all` clears TypeScript artifacts when switching branches.

## Coding Style & Naming Conventions
- `.editorconfig` mandates two-space indentation, UTF-8, and terminal newlines across the repo.
- Prefer async/await, keep command flags strongly typed, and surface user text through the `messages` helpers.
- Name command modules by CLI id (e.g., `src/commands/rflib/logging/apex/instrument.ts`) and export a default `SfCommand`.
- Use proper abstraction to make code more readably following common clean-code guidelines. 

## Testing Guidelines
- Tests run with Mocha + ts-node and coverage is gathered by `c8`, publishing HTML/text into `coverage/`.
- `.nycrc` enforces 75% minimums for statements, branches, functions, and lines; raise coverage before merging.
- Place unit specs as `*.test.ts` beside the subject, and reserve `*.nut.ts` for Salesforce CLI test kit scenarios.
- Allways check for linting errors and fix them before running the unit tests.

## Commit & Pull Request Guidelines
- Follow Conventional Commits (`feat:`, `fix:`, `docs:`â€¦); Husky runs `yarn commitlint --edit` and `npm test`.
- Pre-push hooks execute `yarn build && yarn test`, so keep the suite green locally.
- PR descriptions should cite the affected `sf` command, summarize behaviour, and attach relevant `--dryrun` output.
- Link the driving issue and flag follow-up tasks so maintainers can schedule releases.

## Local CLI Usage
- After compiling, run `sf plugins link .` to exercise the plugin inside your global Salesforce CLI.
- For rapid iteration, execute `node --loader ts-node/esm ./bin/dev.js <command>` instead of reinstalling between edits.
